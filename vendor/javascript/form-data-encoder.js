// form-data-encoder@4.0.2 downloaded from https://ga.jspm.io/npm:form-data-encoder@4.0.2/lib/index.cjs

var e={};var t=Object.defineProperty;var r=Object.getOwnPropertyDescriptor;var n=Object.getOwnPropertyNames;var a=Object.prototype.hasOwnProperty;var __export=(e,r)=>{for(var n in r)t(e,n,{get:r[n],enumerable:true})};var __copyProps=(e,o,i,s)=>{if(o&&"object"===typeof o||"function"===typeof o)for(let c of n(o))a.call(e,c)||c===i||t(e,c,{get:()=>o[c],enumerable:!(s=r(o,c))||s.enumerable});return e};var __toCommonJS=e=>__copyProps(t({},"__esModule",{value:true}),e);var __accessCheck=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var __privateGet=(e,t,r)=>{__accessCheck(e,t,"read from private field");return r?r.call(e):t.get(e)};var __privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)};var __privateSet=(e,t,r,n)=>{__accessCheck(e,t,"write to private field");n?n.call(e,r):t.set(e,r);return r};var __privateMethod=(e,t,r)=>{__accessCheck(e,t,"access private method");return r};var o={};__export(o,{FormDataEncoder:()=>k,isFile:()=>isFile,isFormData:()=>isFormData});e=__toCommonJS(o);var isFunction=e=>"function"===typeof e;var isAsyncIterable=e=>isFunction(e[Symbol.asyncIterator]);var i=65536;function*chunk(e){if(e.byteLength<=i){yield e;return}let t=0;while(t<e.byteLength){const r=Math.min(e.byteLength-t,i);const n=e.buffer.slice(t,t+r);t+=n.byteLength;yield new Uint8Array(n)}}async function*readStream(e){const t=e.getReader();while(true){const{done:e,value:r}=await t.read();if(e)break;yield r}}async function*chunkStream(e){for await(const t of e)yield*chunk(t)}var getStreamIterator=e=>{if(isAsyncIterable(e))return chunkStream(e);if(isFunction(e.getReader))return chunkStream(readStream(e));throw new TypeError("Unsupported data source: Expected either ReadableStream or async iterable.")};var s="abcdefghijklmnopqrstuvwxyz0123456789";function createBoundary(){let e=16;let t="";while(e--)t+=s[Math.random()*s.length<<0];return t}var normalizeValue=e=>String(e).replace(/\r|\n/g,((e,t,r)=>"\r"===e&&"\n"!==r[t+1]||"\n"===e&&"\r"!==r[t-1]?"\r\n":e));var getType=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function isPlainObject(e){if("object"!==getType(e))return false;const t=Object.getPrototypeOf(e);if(null===t||void 0===t)return true;const r=t.constructor&&t.constructor.toString();return r===Object.toString()}function getProperty(e,t){if("string"===typeof t)for(const[r,n]of Object.entries(e))if(t.toLowerCase()===r.toLowerCase())return n}var proxyHeaders=e=>new Proxy(e,{get:(e,t)=>getProperty(e,t),has:(e,t)=>void 0!==getProperty(e,t)});var isFormData=e=>Boolean(e&&isFunction(e.constructor)&&"FormData"===e[Symbol.toStringTag]&&isFunction(e.append)&&isFunction(e.getAll)&&isFunction(e.entries)&&isFunction(e[Symbol.iterator]));var escapeName=e=>String(e).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22");var isFile=e=>Boolean(e&&"object"===typeof e&&isFunction(e.constructor)&&"File"===e[Symbol.toStringTag]&&isFunction(e.stream)&&null!=e.name);var c={enableAdditionalHeaders:false};var h={writable:false,configurable:false};var l,d,u,y,f,p,b,g,m,v,w,S;var k=class{constructor(e,t,r){__privateAdd(this,m);__privateAdd(this,w);__privateAdd(this,l,"\r\n");__privateAdd(this,d,void 0);__privateAdd(this,u,void 0);__privateAdd(this,y,"-".repeat(2));__privateAdd(this,f,new TextEncoder);__privateAdd(this,p,void 0);__privateAdd(this,b,void 0);__privateAdd(this,g,void 0);if(!isFormData(e))throw new TypeError("Expected first argument to be a FormData instance.");let n;isPlainObject(t)?r=t:n=t;n||(n=createBoundary());if("string"!==typeof n)throw new TypeError("Expected boundary argument to be a string.");if(r&&!isPlainObject(r))throw new TypeError("Expected options argument to be an object.");__privateSet(this,b,Array.from(e.entries()));__privateSet(this,g,{...c,...r});__privateSet(this,d,__privateGet(this,f).encode(__privateGet(this,l)));__privateSet(this,u,__privateGet(this,d).byteLength);this.boundary=`form-data-boundary-${n}`;this.contentType=`multipart/form-data; boundary=${this.boundary}`;__privateSet(this,p,__privateGet(this,f).encode(`${__privateGet(this,y)}${this.boundary}${__privateGet(this,y)}${__privateGet(this,l).repeat(2)}`));const a={"Content-Type":this.contentType};const o=__privateMethod(this,w,S).call(this);if(o){this.contentLength=o;a["Content-Length"]=o}this.headers=proxyHeaders(Object.freeze(a));Object.defineProperties(this,{boundary:h,contentType:h,contentLength:h,headers:h})}*values(){for(const[e,t]of __privateGet(this,b)){const r=isFile(t)?t:__privateGet(this,f).encode(normalizeValue(t));yield __privateMethod(this,m,v).call(this,e,r);yield r;yield __privateGet(this,d)}yield __privateGet(this,p)}async*encode(){for(const e of this.values())isFile(e)?yield*getStreamIterator(e.stream()):yield*chunk(e)}[Symbol.iterator](){return this.values()}[Symbol.asyncIterator](){return this.encode()}};l=new WeakMap;d=new WeakMap;u=new WeakMap;y=new WeakMap;f=new WeakMap;p=new WeakMap;b=new WeakMap;g=new WeakMap;m=new WeakSet;v=function(e,t){let r="";r+=`${__privateGet(this,y)}${this.boundary}${__privateGet(this,l)}`;r+=`Content-Disposition: form-data; name="${escapeName(e)}"`;if(isFile(t)){r+=`; filename="${escapeName(t.name)}"${__privateGet(this,l)}`;r+=`Content-Type: ${t.type||"application/octet-stream"}`}if(true===__privateGet(this,g).enableAdditionalHeaders){const e=isFile(t)?t.size:t.byteLength;null==e||isNaN(e)||(r+=`${__privateGet(this,l)}Content-Length: ${e}`)}return __privateGet(this,f).encode(`${r}${__privateGet(this,l).repeat(2)}`)};w=new WeakSet;S=function(){let e=0;for(const[t,r]of __privateGet(this,b)){const n=isFile(r)?r:__privateGet(this,f).encode(normalizeValue(r));const a=isFile(n)?n.size:n.byteLength;if(null==a||isNaN(a))return;e+=__privateMethod(this,m,v).call(this,t,n).byteLength;e+=a;e+=__privateGet(this,u)}return String(e+__privateGet(this,p).byteLength)};0;var j=e;const O=e.FormDataEncoder,$=e.isFile,L=e.isFormData;export{O as FormDataEncoder,j as default,$ as isFile,L as isFormData};

